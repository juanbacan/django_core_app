{% load core_extras %}

<table class="table small table-hover table-striped">
  <thead>
    <tr>
      {% for col in list_display %}
        <th>{{ col|capfirst }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for obj in object_list %}
      <tr data-pk="{{ obj.pk }}" data-label="{{ obj }}" style="cursor: pointer;">
        {% for col in list_display %}
          <td>{{ obj|attr:col }}</td>
        {% endfor %}
      </tr>
    {% empty %}
      <tr><td colspan="{{ list_display|length }}">Sin resultados</td></tr>
    {% endfor %}
  </tbody>
</table>

<nav>
  <ul class="pagination pagination-sm">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="#" data-page="{{ page_obj.previous_page_number }}">«</a></li>
    {% endif %}
    {% for p in page_obj.paginator.page_range %}
      <li class="page-item {% if p == page_obj.number %}active{% endif %}">
        <a class="page-link" href="#" data-page="{{ p }}">{{ p }}</a>
      </li>
    {% endfor %}
    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="#" data-page="{{ page_obj.next_page_number }}">»</a></li>
    {% endif %}
  </ul>
</nav>

<script>
  document.currentScript.parentNode.addEventListener("click", e => {
    if (e.target.matches("[data-page]")) {
      e.preventDefault();
      const page = e.target.dataset.page;
      const q = document.querySelector("[data-fk-search]").value;
      window.fetchPage(q, page);   // función global definida en el <script> de arriba
    }
  });
</script>
